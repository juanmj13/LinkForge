# Device Health Monitor

Dockerâ€‘ready TypeScript microservice for Windows  device health monitoring. Publishes JSON payloads over MQTT with system metadata, performance metrics, and configurable settings via anÂ `.env`.

---

## Features

- Gathers device info (manufacturer, model, serial, UUID)  
- Monitors performance (% CPU, RAM, Disk, GPU utilization)  
- Publishes at configurable intervals over MQTT  
- Fully configurable viaÂ `.env`  
- Graceful error handling to let Docker autoâ€‘restart on failures  

---

## Project Structure

```
device-health-monitor/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ index.ts                 # Main entry point
â”‚   â”œâ”€â”€ functions/
â”‚   â”‚   â””â”€â”€ functions.ts         # Data gathering & publishing logic
â”‚   â””â”€â”€ interfaces/
â”‚       â””â”€â”€ interfaces.ts        # TypeScript interfaces
â”œâ”€â”€ .env.example                 # Sample environment variables
â”œâ”€â”€ Dockerfile                   # Multiâ€‘stage Docker build
â”œâ”€â”€ .dockerignore
â”œâ”€â”€ package.json
â”œâ”€â”€ tsconfig.json
â””â”€â”€ README.md
```

---

## Prerequisites

- Node.js v16+  
- Docker (optional, for containerized deployment)  

---

## Setup

1. **Clone the repo**  
   ```bash
   git clone <your-repo-url>
   cd device-health-monitor
   ```

2. **Install dependencies**  
   ```bash
   npm install
   ```

3. **Configure environment**  
   Copy and edit:
   ```bash
   cp .env.example .env
   ```
   Fill in:
   ```
   MQTT_HOST=your-broker.host
   MQTT_PORT=8883
   MQTT_TLS=true
   MQTT_USER=yourUser
   MQTT_PASSWORD=yourPass
   MQTT_TOPIC=Your/Topic
   DEVICE_NAME=YourDeviceName
   PUBLISH_INTERVAL=1000
   ```

---

## Scripts

- **build**  
  ```bash
  npm run build
  ```
  Transpiles TypeScript â†’ JavaScript inÂ `dist/`.

- **start**  
  ```bash
  npm run start
  ```
  Builds then runs `dist/index.js`.

- **dev**  
  ```bash
  npm run dev
  ```
  Runs `src/index.ts` via `ts-node` for hot reload.

---

## Docker

1. **Build image**  
   ```bash
   docker build -t device-health-monitor .
   ```

2. **Run container**  
   ```bash
   docker run -d      --name device-health      --restart on-failure      --env-file .env      device-health-monitor
   ```

---

## Usage

Once running, the service logs:

```
âœ… Connected to MQTT
ðŸ•’ Publishing data every <interval> ms to <topic>
ðŸ“¤ Published to <topic>
```

Check your MQTT broker for incoming JSON messages.

## License
MIT

## Author
- Juan Manuel JimÃ©nez [juan.jimenez.c13@gmail.com]

